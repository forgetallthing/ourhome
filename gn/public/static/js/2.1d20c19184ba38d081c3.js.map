{"version":3,"sources":["webpack:///src/components/socket.vue","webpack:///./src/components/socket.vue?d109","webpack:///./src/components/socket.vue"],"names":["socket","props","name","data","wsStateValue","textarea","socked","chat_list","wsState","userNickname","socketId","undefined","userPhoto","onlineTotal","photoList","computed","created","mounted","that","this","document","onkeydown","e","window","event","keyCode","which","send","watch","methods","connect","_this","random","Math","floor","lib_default","forceNew","on","id","emit","message","showMes","count","openUserNicknameInput","close","mes","time","Date","photo","$message","type","push","$nextTick","msg_end","scrollIntoView","_this2","$prompt","confirmButtonText","cancelButtonText","inputPattern","inputErrorMessage","then","_ref","value","catch","components","components_socket","render","_vm","_h","$createElement","_c","_self","staticStyle","height","staticClass","_l","item","index","key","attrs","src","alt","_v","_s","clear","overflow","rows","placeholder","model","callback","$$v","expression","inactive-text","active-color","inactive-color","change","size","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/2.1d20c19184ba38d081c3.js","sourcesContent":["<template>\r\n  <div style=\"height:100%\">\r\n    <div class=\"talk\">\r\n      <div v-for=\"(item,index) in chat_list\" :key='index'>\r\n        <div v-if=\"item.id && item.id!=socketId\" class=\"mes-contain\">\r\n          <img class=\"userPhoto userPhoto-left\" :src=\"item.photo\" alt=\"\">\r\n          <div class=\"userName userName-left\">{{item.name}}</div>\r\n          <div class=\"userMes userMes-left\">{{item.mes}}</div>\r\n          <br style='clear:both' />\r\n        </div>\r\n        <div v-else-if=\"item.id && item.id==socketId\" class=\"mes-contain\">\r\n          <img class=\"userPhoto userPhoto-right\" :src=\"item.photo\" alt=\"\">\r\n          <div class=\"userName userName-right\">{{item.name}}</div>\r\n          <div class=\"userMes userMes-right\">{{item.mes}}</div>\r\n          <br style='clear:both' />\r\n        </div>\r\n        <div class=\"broad\" v-else-if=\"item.into\"><span class=\"broad-text\">{{item.name}}闪亮登场!!!</span></div>\r\n        <div class=\"broad\" v-else><span class=\"broad-text\">{{item.name}}夹着尾巴逃了</span></div>\r\n      </div>\r\n      <div id=\"msg_end\" style=\"height:0px; overflow:hidden\"></div>\r\n    </div>\r\n    <el-input class=\"mes-content\" type=\"textarea\" :rows=\"2\" placeholder=\"请输入内容\" v-model=\"textarea\">\r\n    </el-input>\r\n    <div class=\"mes-set\">\r\n      <span>当前在线：{{onlineTotal}}</span>\r\n      <el-switch class=\"mes-swich\" @change='connect' v-model=\"wsStateValue\" :inactive-text='wsState' active-color=\"#13ce66\" inactive-color=\"#0089A7\">\r\n      </el-switch>\r\n      <el-button class=\"mes-send\" size='small' @click=\"send\" type=\"primary\">send</el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SocketIO from \"socket.io-client\";\r\nexport default {\r\n  props: {},\r\n  name: \"socket\",\r\n  data() {\r\n    return {\r\n      wsStateValue: false,\r\n      textarea: \"\",\r\n      socked: null,\r\n      chat_list: [],\r\n      wsState: \"已关闭:\",\r\n      userNickname: null,\r\n      socketId: undefined,\r\n      userPhoto: null,\r\n      onlineTotal: 0,\r\n      photoList: [\r\n        \"../../static/man.png\",\r\n        \"../../static/women.png\",\r\n        \"../../static/child.png\",\r\n        \"../../static/fiwomen.png\"\r\n      ]\r\n    };\r\n  },\r\n  computed: {},\r\n  created() {},\r\n  mounted() {\r\n    let that = this;\r\n    document.onkeydown = function(e) {\r\n      if (!e) {\r\n        e = window.event;\r\n      }\r\n      if ((e.keyCode || e.which) == 13) {\r\n        that.send();\r\n        return false;\r\n      }\r\n    };\r\n  },\r\n  watch: {},\r\n  methods: {\r\n    connect() {\r\n      //随机头像\r\n      if (!this.userPhoto) {\r\n        let random = Math.floor(Math.random() * 4);\r\n        this.userPhoto = this.photoList[random];\r\n      }\r\n      if (this.wsStateValue) {\r\n        this.wsState = \"已连接:\";\r\n        if (!this.userNickname) {\r\n          this.openUserNicknameInput();\r\n        } else {\r\n          this.socket = SocketIO(\"http://ipromiseyourlife.com:9999\", {\r\n            forceNew: false\r\n          });\r\n          let that = this;\r\n          this.socket.on(\"connect\", () => {\r\n            this.socketId = this.socket.id;\r\n          });\r\n          this.socket.emit(\"join\", { name: this.userNickname });\r\n          this.socket.on(\"message\", function(message) {\r\n            that.showMes(message);\r\n          });\r\n          this.socket.on(\"joinNoticeSelf\", function(message) {\r\n            that.onlineTotal = message.count;\r\n          });\r\n          this.socket.on(\"joinNoticeOther\", function(message) {\r\n            that.showMes(message);\r\n            that.onlineTotal = message.count;\r\n          });\r\n          this.socket.on(\"disconnection\", function(message) {\r\n            that.showMes(message);\r\n            that.onlineTotal = message.count;\r\n          });\r\n        }\r\n      } else {\r\n        this.socket.close();\r\n        this.socket = null;\r\n        this.onlineTotal = 0;\r\n        this.chat_list = [];\r\n        this.wsState = \"已关闭:\";\r\n        this.userPhoto = null;\r\n        this.userNickname = null;\r\n      }\r\n    },\r\n    send() {\r\n      if (!this.textarea) {\r\n        this.$message({\r\n          type: \"info\",\r\n          message: \"请多少输入点啥吧~\"\r\n        });\r\n      } else if (this.socket) {\r\n        const message = {\r\n          id: this.socketId,\r\n          name: this.userNickname,\r\n          mes: this.textarea,\r\n          time: new Date(),\r\n          photo: this.userPhoto\r\n        };\r\n        this.socket.send(message);\r\n        this.textarea = null;\r\n      } else {\r\n        this.$message({\r\n          type: \"info\",\r\n          message: \"您还没进入聊天室~\"\r\n        });\r\n      }\r\n    },\r\n    showMes(message) {\r\n      this.chat_list.push(message);\r\n      if (message.id === this.socketId) {\r\n        this.$nextTick(function() {\r\n          msg_end.scrollIntoView();\r\n        });\r\n      }\r\n    },\r\n    openUserNicknameInput() {\r\n      this.$prompt(\"请输入聊天昵称\", \"GN在线\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        inputPattern: /^[\\W\\w]*?/,\r\n        inputErrorMessage: \"昵称格式不正确\"\r\n      })\r\n        .then(({ value }) => {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"你的昵称是: \" + value\r\n          });\r\n          this.userNickname = value;\r\n          this.connect();\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"取消输入,没有昵称无法进入哦~\"\r\n          });\r\n          this.wsState = \"已关闭:\";\r\n          this.wsStateValue = false;\r\n        });\r\n    }\r\n  },\r\n  components: {}\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.talk {\r\n  width: 100%;\r\n  height: 80%;\r\n  overflow-y: scroll;\r\n  border: 1px solid #cccccc;\r\n}\r\n.mes-content {\r\n  margin-top: 12px;\r\n}\r\n.mes-set {\r\n  margin-top: 10px;\r\n}\r\n.mes-swich {\r\n  margin: 6px 20px;\r\n}\r\n.mes-send {\r\n  float: right;\r\n  width: 150px;\r\n  height: 40px;\r\n  background-color: #0089a7;\r\n  font-size: 18px;\r\n}\r\n.mes-contain {\r\n  width: 96%;\r\n  height: auto;\r\n  margin: 22px 2%;\r\n  position: relative;\r\n}\r\n.broad{\r\n  text-align: center;\r\n  font-size: 16px;\r\n  color: #255359;\r\n  margin: 15px 0;\r\n}\r\n.broad-text{\r\n  display: inline-block;\r\n  padding: 5px 5px;\r\n  background: #cccccc;\r\n  border-radius: 8%;\r\n}\r\n.userPhoto {\r\n  width: 70px;\r\n  height: 70px;\r\n  object-fit: cover;\r\n  border-radius: 50%;\r\n}\r\n.userName {\r\n  margin: 10px 16px;\r\n  font-size: 16px;\r\n  color: #26453d;\r\n  width: calc(100% - 120px);\r\n}\r\n.userMes {\r\n  margin: 0 15px;\r\n  background-color: #a5dee4;\r\n  padding: 16px 19px;\r\n  border-radius: 8%;\r\n  max-width: 36%;\r\n  word-wrap: break-word;\r\n  font-size: 16px;\r\n  line-height: 22px;\r\n}\r\n.userPhoto-left,\r\n.userName-left,\r\n.userMes-left {\r\n  float: left;\r\n}\r\n.userPhoto-right,\r\n.userName-right,\r\n.userMes-right {\r\n  float: right;\r\n}\r\n.userName-right {\r\n  text-align: right;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/socket.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"height\":\"100%\"}},[_c('div',{staticClass:\"talk\"},[_vm._l((_vm.chat_list),function(item,index){return _c('div',{key:index},[(item.id && item.id!=_vm.socketId)?_c('div',{staticClass:\"mes-contain\"},[_c('img',{staticClass:\"userPhoto userPhoto-left\",attrs:{\"src\":item.photo,\"alt\":\"\"}}),_vm._v(\" \"),_c('div',{staticClass:\"userName userName-left\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('div',{staticClass:\"userMes userMes-left\"},[_vm._v(_vm._s(item.mes))]),_vm._v(\" \"),_c('br',{staticStyle:{\"clear\":\"both\"}})]):(item.id && item.id==_vm.socketId)?_c('div',{staticClass:\"mes-contain\"},[_c('img',{staticClass:\"userPhoto userPhoto-right\",attrs:{\"src\":item.photo,\"alt\":\"\"}}),_vm._v(\" \"),_c('div',{staticClass:\"userName userName-right\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('div',{staticClass:\"userMes userMes-right\"},[_vm._v(_vm._s(item.mes))]),_vm._v(\" \"),_c('br',{staticStyle:{\"clear\":\"both\"}})]):(item.into)?_c('div',{staticClass:\"broad\"},[_c('span',{staticClass:\"broad-text\"},[_vm._v(_vm._s(item.name)+\"闪亮登场!!!\")])]):_c('div',{staticClass:\"broad\"},[_c('span',{staticClass:\"broad-text\"},[_vm._v(_vm._s(item.name)+\"夹着尾巴逃了\")])])])}),_vm._v(\" \"),_c('div',{staticStyle:{\"height\":\"0px\",\"overflow\":\"hidden\"},attrs:{\"id\":\"msg_end\"}})],2),_vm._v(\" \"),_c('el-input',{staticClass:\"mes-content\",attrs:{\"type\":\"textarea\",\"rows\":2,\"placeholder\":\"请输入内容\"},model:{value:(_vm.textarea),callback:function ($$v) {_vm.textarea=$$v},expression:\"textarea\"}}),_vm._v(\" \"),_c('div',{staticClass:\"mes-set\"},[_c('span',[_vm._v(\"当前在线：\"+_vm._s(_vm.onlineTotal))]),_vm._v(\" \"),_c('el-switch',{staticClass:\"mes-swich\",attrs:{\"inactive-text\":_vm.wsState,\"active-color\":\"#13ce66\",\"inactive-color\":\"#0089A7\"},on:{\"change\":_vm.connect},model:{value:(_vm.wsStateValue),callback:function ($$v) {_vm.wsStateValue=$$v},expression:\"wsStateValue\"}}),_vm._v(\" \"),_c('el-button',{staticClass:\"mes-send\",attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.send}},[_vm._v(\"send\")])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-8df35db4\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/socket.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-8df35db4\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./socket.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./socket.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./socket.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-8df35db4\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./socket.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-8df35db4\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/socket.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}